---
import Layout from '@/layouts/MainLayout.astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

// Get all projects from the content collection
const allProjects = await getCollection('projects');

// Define categories with their descriptions and corresponding tags
const categories = [
  {
    id: "handyman",
    title: "Handyman",
    tag: "handyman",
    description: "Joe The Guy offers reliable, no-nonsense handyman services for homeowners who just need the job done right. From minor repairs and home improvements to larger renovation projects, Joe handles it all with skill, honesty, and attention to detail. Whether it's fixing, building, or hauling, you can count on Joe to show up on time, work efficiently, and leave your space better than he found it. When life gets cluttered or projects pile up â€” Joe's your guy.",
  },
  {
    id: "kitchens",
    title: "Kitchens",
    tag: "kitchen",
    description: "Transform your kitchen into a stunning culinary space with our expert renovation services. Our team combines functionality with aesthetic appeal to create kitchens that become the heart of your home. From modern minimalist designs to classic traditional styles, we deliver exceptional craftsmanship tailored to your specific needs and budget.",
  },
  {
    id: "bathrooms",
    title: "Bathrooms",
    tag: "bathroom",
    description: "Elevate your daily routine with our premium bathroom renovations. We specialize in creating spa-like retreats that offer both luxury and practicality. Our attention to detail ensures waterproof installations, elegant fixtures, and perfect tilework that stands the test of time.",
  },
  {
    id: "interiors",
    title: "Interiors",
    tag: "interior",
    description: "Breathe new life into your living spaces with our comprehensive interior renovation services. From flooring and lighting to paint and custom cabinetry, we handle every aspect of interior transformation. Our designers work closely with you to reflect your personal style while maximizing space and functionality.",
  },
  {
    id: "exteriors",
    title: "Exteriors",
    tag: "exterior",
    description: "Make a lasting impression with our exterior renovation expertise. We enhance curb appeal through quality siding, roofing, windows, and outdoor living spaces. Our durable materials and precise installation techniques ensure your home's exterior remains beautiful and protected for years to come.",
  },
  {
    id: "commercial",
    title: "Commercial",
    tag: "commercial",
    description: "Elevate your business space with our commercial renovation solutions. We understand that time is money, which is why we deliver efficient, high-quality renovations with minimal disruption to your operations. From office remodels to retail store upgrades, we help businesses create environments that impress clients and enhance productivity.",
  }
];

// Group projects by category tags
const categoriesWithProjects = categories.map(category => {
  const categoryProjects = allProjects.filter(project =>
    project.data.tags?.some(tag => tag.toLowerCase() === category.tag.toLowerCase())
  );

  return {
    ...category,
    projects: categoryProjects
  };
}).filter(category => category.projects.length > 0); // Only show categories with projects

const keywords = ["Home Remodeling", "dumpsters", "dumpster",];
---

<Layout title="Project Portfolio | Joe The Guy" keywords={keywords}>
  <main class="w-full bg-white">
    <!-- Hero Section -->
    <section class="w-full bg-secondary-light py-16">
      <div class="container mx-auto px-4">
        <h1 class="text-4xl font-bold text-center uppercase font-raleway">Joe's Project Portfolio</h1>
        <div class="mx-auto w-24 h-1 bg-primary mb-6 mt-4"></div>
        <p class="text-center text-lg max-w-4xl mx-auto mt-8">
            Discover the exceptional renovation projects we've completed recently. Each transformation highlights our dedication to superior craftsmanship, meticulous attention to detail, and unwavering client satisfaction, and most importantly CLEANING UP AFTER OURSELVES. We shouldn't have to say this but not every handyman leaves your home better than they found it. But we take pride in our tidiness from the beginning of the job, to the end.
        </p>
        <p class="text-center text-lg max-w-4xl mx-auto mt-8">
            From kitchen and bathroom remodels to comprehensive home renovations, we bring your vision to life. If you need a reliable expert for repairs or remodels, call Joe The Guy.
        </p>
      </div>
    </section>

    <!-- Category Navigation -->
    <section class="bg-white py-8 border-b border-gray-200">
      <div class="container mx-auto px-4">
        <div class="flex flex-wrap justify-center gap-6">
          {categoriesWithProjects.map(category => (
            <a href={`#${category.id}`} class="px-6 py-2 bg-gray-100 hover:bg-primary hover:text-white rounded-full transition duration-300 font-raleway font-medium uppercase text-sm">
              {category.title}
            </a>
          ))}
        </div>
      </div>
    </section>

    <!-- Project Categories -->
    {categoriesWithProjects.map((category, index) => (
      <section id={category.id} class={`py-16 ${index % 2 === 0 ? 'bg-white' : 'bg-secondary-light'}`}>
        <div class="container mx-auto px-4">
          <h2 class="text-3xl font-semibold uppercase font-raleway text-primary text-center">{category.title}</h2>
          <div class="w-16 h-1 bg-primary mt-3 mb-6 mx-auto"></div>
          <p class="text-lg mb-12 text-center max-w-4xl mx-auto">{category.description}</p>

          <!-- Projects Grid -->
          <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            {category.projects.map((project) => (
              <div class="flex-col">
                <a href={`/projects/${project.slug}`}>
                  {project.data.featuredImage && (
                    <Image
                      src={project.data.featuredImage}
                      alt={project.data.title}
                      class="w-full h-64 object-cover rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300"
                    />
                  )}
                  <h3 class="text-xl text-center font-semibold text-primary p-2 uppercase mt-2">{project.data.title}</h3>
                  {project.data.subTitle && (
                    <p class="text-sm text-center text-gray-600 px-2">{project.data.subTitle}</p>
                  )}
                </a>
              </div>
            ))}
          </div>

          <div class="mt-12 text-center">
            <a href="/contact" class="inline-block bg-primary text-white font-semibold px-8 py-3 rounded-xl hover:bg-accent1 transition duration-300">
              Request a Quote
            </a>
          </div>
        </div>
      </section>
    ))}

    <!-- Call to Action -->
    <section class="bg-primary py-16 text-white">
      <div class="container mx-auto px-4 text-center">
        <h2 class="text-3xl font-bold mb-4">Ready to Transform Your Space?</h2>
        <p class="text-xl mb-8 max-w-3xl mx-auto">
          Let's discuss how we can bring your renovation vision to life. Our team of experts is ready to help you create the space you've always wanted.
        </p>
        <div class="flex justify-center gap-6">
          <a href="/contact" class="bg-white text-primary font-bold py-3 px-8 rounded-xl hover:bg-gray-100 transition duration-300">
            Contact Us
          </a>
          <a href="/cost-calculator" class="bg-accent1 text-white font-bold py-3 px-8 rounded-xl hover:bg-opacity-90 transition duration-300">
            Get an Estimate
          </a>
        </div>
      </div>
    </section>
  </main>
</Layout>
